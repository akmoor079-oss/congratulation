<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>–ú–∏–Ω–∏-–∫–∞–∑–∏–Ω–æ ‚Äî –°–ª–æ—Ç-–º–∞—à–∏–Ω–∞</title>
  <style>
    :root{--bg:#0f1724;--card:#0b1220;--accent:#f59e0b;--muted:#94a3b8;--glass:rgba(255,255,255,0.03)}
    *{box-sizing:border-box;font-family:Inter,ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,'Helvetica Neue',Arial}
    body{margin:0;min-height:100vh;background:linear-gradient(180deg,#041226 0%, #081426 60%);color:#e6eef8;display:flex;align-items:center;justify-content:center;padding:24px}
    .app{width:100%;max-width:980px;border-radius:14px;padding:20px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));box-shadow:0 10px 30px rgba(2,6,23,0.6)}
    header{display:flex;align-items:center;justify-content:space-between;margin-bottom:18px}
    h1{font-size:20px;margin:0;display:flex;align-items:center;gap:12px}
    .logo{width:44px;height:44px;border-radius:10px;background:linear-gradient(135deg,var(--accent),#ef4444);display:grid;place-items:center;font-weight:700;color:#061024}
    .stats{display:flex;gap:12px;align-items:center}
    .stat{background:var(--glass);padding:8px 12px;border-radius:10px;color:var(--muted);font-size:14px}
    .main{display:grid;grid-template-columns:1fr 360px;gap:18px}

    /* Slot area */
    .slot{background:linear-gradient(180deg,#071024, #071229);padding:18px;border-radius:12px;border:1px solid rgba(255,255,255,0.03)}
    .reel{display:flex;gap:12px;justify-content:center;margin-bottom:14px}
    .column{background:rgba(255,255,255,0.02);width:96px;height:220px;border-radius:10px;padding:8px;display:flex;flex-direction:column;align-items:center;justify-content:space-between;overflow:hidden;border:1px solid rgba(255,255,255,0.03)}
    .symbol{width:80px;height:64px;border-radius:8px;background:#071b2b;display:grid;place-items:center;font-weight:700;font-size:22px;color:#e6eef8;transform:translateY(0);transition:transform 300ms cubic-bezier(.2,.9,.25,1)}
    .controls{display:flex;gap:8px;align-items:center;justify-content:center}
    .btn{background:linear-gradient(180deg,#0ea5a3,#0891b2);border:none;padding:10px 14px;border-radius:10px;color:#051022;font-weight:700;cursor:pointer}
    .btn.secondary{background:transparent;color:var(--accent);border:1px solid rgba(255,255,255,0.05)}
    .bet{display:flex;gap:8px;align-items:center}

    /* Sidebar */
    .sidebar{background:linear-gradient(180deg,#061426,#071429);padding:18px;border-radius:12px;border:1px solid rgba(255,255,255,0.03)}
    .balance{font-size:22px;font-weight:800;margin-bottom:8px}
    .small{color:var(--muted);font-size:13px}

    .history{margin-top:12px;max-height:200px;overflow:auto}
    .history div{padding:8px;border-radius:8px;background:rgba(255,255,255,0.015);margin-bottom:8px;font-size:13px}

    footer{margin-top:16px;color:var(--muted);font-size:13px;display:flex;justify-content:space-between}

    /* Win highlight */
    .win{animation:win 950ms ease-in-out}
    @keyframes win{0%{transform:scale(1)}50%{transform:scale(1.06)}100%{transform:scale(1)}}

    /* Responsive */
    @media(max-width:880px){.main{grid-template-columns:1fr;}.sidebar{order:2}}
  </style>
</head>
<body>
  <div class="app">
    <header>
      <h1><div class="logo">CZ</div>–ú–∏–Ω–∏-–∫–∞–∑–∏–Ω–æ ‚Äî —Å–ª–æ—Ç-–º–∞—à–∏–Ω–∞</h1>
      <div class="stats">
        <div class="stat">–ë–∞–ª–∞–Ω—Å: <strong id="top-balance">0</strong> üíé</div>
        <div class="stat">–í—Å–µ–≥–æ –∏–≥—Ä: <strong id="games-played">0</strong></div>
      </div>
    </header>

    <div class="main">
      <section class="slot">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px">
          <div>
            <div class="small">–°—Ç–∞–≤–∫–∞</div>
            <div style="font-weight:700;font-size:18px" id="bet-amount">10</div>
          </div>
          <div>
            <div class="small">–ü–æ—Å–ª–µ–¥–Ω–∏–π –≤—ã–∏–≥—Ä—ã—à</div>
            <div style="font-weight:700;font-size:18px;color:var(--accent)" id="last-win">0</div>
          </div>
          <div>
            <div class="small">–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã</div>
            <div class="small">3 –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö ‚Äî x10 ¬∑ 2 –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö ‚Äî x2</div>
          </div>
        </div>

        <div class="reel" id="reel">
          <div class="column" data-col="0">
            <div class="symbol" id="s0">üçí</div>
            <div class="symbol" id="s1">üçã</div>
            <div class="symbol" id="s2">üîî</div>
          </div>
          <div class="column" data-col="1">
            <div class="symbol" id="s3">üçí</div>
            <div class="symbol" id="s4">üçã</div>
            <div class="symbol" id="s5">üîî</div>
          </div>
          <div class="column" data-col="2">
            <div class="symbol" id="s6">üçí</div>
            <div class="symbol" id="s7">üçã</div>
            <div class="symbol" id="s8">üîî</div>
          </div>
        </div>

        <div class="controls">
          <div class="bet">
            <button class="btn secondary" id="bet-decrease">-</button>
            <button class="btn secondary" id="bet-increase">+</button>
          </div>
          <button class="btn" id="spin">SPIN</button>
          <button class="btn secondary" id="max-bet">MAX</button>
        </div>

        <div style="margin-top:12px;text-align:center;color:var(--muted);font-size:13px">–ò–≥—Ä–∞ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –∏ —Ä–∞–∑–≤–ª–µ—á–µ–Ω–∏—è. –ù–∏–∫–∞–∫–∏–µ —Ä–µ–∞–ª—å–Ω—ã–µ –¥–µ–Ω—å–≥–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è.</div>
      </section>

      <aside class="sidebar">
        <div class="balance">–ë–∞–ª–∞–Ω—Å: <span id="balance">1000</span> üíé</div>
        <div class="small">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: —Å—Ç–∞–≤—å—Ç–µ, –Ω–∞–∂–∏–º–∞–π—Ç–µ SPIN. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—ã–ø–ª–∞—Ç.</div>

        <div style="margin-top:12px">
          <button class="btn" id="give-100">–î–∞—Ç—å +100</button>
          <button class="btn secondary" id="reset">–°–±—Ä–æ—Å</button>
        </div>

        <div class="history" id="history"></div>
      </aside>
    </div>

    <footer>
      <div>–í–µ—Ä—Å–∏—è: 1.0 ‚Äî –ª–æ–∫–∞–ª—å–Ω–∞—è –¥–µ–º–æ-–∏–≥—Ä–∞</div>
      <div>–°–¥–µ–ª–∞–Ω–æ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è ‚Äî –±–µ–∑ —Ä–µ–∞–ª—å–Ω–æ–π –≤–∞–ª—é—Ç—ã</div>
    </footer>
  </div>

  <script>
    // –≠–ª–µ–º–µ–Ω—Ç—ã
    const balanceEl = document.getElementById('balance');
    const topBalanceEl = document.getElementById('top-balance');
    const betAmountEl = document.getElementById('bet-amount');
    const lastWinEl = document.getElementById('last-win');
    const spinBtn = document.getElementById('spin');
    const betInc = document.getElementById('bet-increase');
    const betDec = document.getElementById('bet-decrease');
    const maxBtn = document.getElementById('max-bet');
    const historyEl = document.getElementById('history');
    const sEls = Array.from(document.querySelectorAll('.symbol'));
    const give100 = document.getElementById('give-100');
    const resetBtn = document.getElementById('reset');
    const gamesPlayedEl = document.getElementById('games-played');

    // –ò–Ω–∏—Ü–∏–∞–ª–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
    let balance = 1000;
    let bet = 10;
    let lastWin = 0;
    let gamesPlayed = 0;

    const symbols = ['üçí','üçã','üîî','üíé','7Ô∏è‚É£'];

    // –û—Ç–æ–±—Ä–∞–∑–∏—Ç—å –Ω–∞—á–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
    function render() {
      balanceEl.textContent = balance;
      topBalanceEl.textContent = balance;
      betAmountEl.textContent = bet;
      lastWinEl.textContent = lastWin;
      gamesPlayedEl.textContent = gamesPlayed;
    }
    render();

    // –£—Ç–∏–ª–∏—Ç—ã
    function randomInt(max){return Math.floor(Math.random()*max)}

    function spinReels(){
      // –∫–∞–∂–¥–∞—è –∫–æ–ª–æ–Ω–∫–∞ –ø–æ–ª—É—á–∞–µ—Ç —Å–ª—É—á–∞–π–Ω—É—é –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å
      const result = [];
      for(let col=0;col<3;col++){
        // –≤—ã–±–µ—Ä–µ–º —Ç—Ä–∏ —Å–∏–º–≤–æ–ª–∞ –¥–ª—è —ç—Ç–æ–π –∫–æ–ª–æ–Ω–∫–∏
        const colSymbols = [];
        for(let r=0;r<3;r++) colSymbols.push(symbols[randomInt(symbols.length)]);
        result.push(colSymbols);
      }
      return result; // —Ñ–æ—Ä–º–∞—Ç: [ [c0r0,c0r1,c0r2], [c1...], [c2...] ]
    }

    function evaluate(result){
      // –°—á–∏—Ç–∞–µ–º —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—É—é –ª–∏–Ω–∏—é (row 1)
      const middle = [result[0][1], result[1][1], result[2][1]];
      // –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö
      const counts = {};
      middle.forEach(s=>counts[s]=(counts[s]||0)+1);
      // –ø–æ–±–µ–¥–∞
      let payout = 0;
      let reason = '';
      // 3 –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö
      for(const sym in counts){
        if(counts[sym]===3){
          // –±–æ–ª–µ–µ —Ä–µ–¥–∫–∏–µ —Å–∏–º–≤–æ–ª—ã ‚Äî –≤—ã—à–µ –º–Ω–æ–∂–∏—Ç–µ–ª—å
          const mult = sym==='7Ô∏è‚É£'?50:(sym==='üíé'?20:10);
          payout = bet * mult;
          reason = `3√ó ${sym} ‚Äî x${mult}`;
          return {payout,reason,winningSymbols:middle};
        }
        if(counts[sym]===2){
          payout = bet * 2;
          reason = `2√ó ${sym} ‚Äî x2`;
          // continue looking for 3 of a kind
        }
      }
      return {payout,reason,winningSymbols:middle};
    }

    // –ê–Ω–∏–º–∞—Ü–∏—è –∏ –ø–æ–∫–∞–∑
    function animateToResult(result){
      // result: array col->rows
      // –¥–ª—è —É–ø—Ä–æ—â–µ–Ω–∏—è ‚Äî –ø—Ä–æ—Å—Ç–æ –º–µ–Ω—è–µ–º —Ç–µ–∫—Å—Ç—ã —Å –∞–Ω–∏–º–∞—Ü–∏–µ–π
      sEls.forEach(el=>el.classList.remove('win'));
      // –ø–æ–∫–∞–∑–∞–µ–º —Å–Ω–∞—á–∞–ª–∞ —Å–ª—É—á–∞–π–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã (–∏–º–∏—Ç–∞—Ü–∏—è –≤—Ä–∞—â–µ–Ω–∏—è)
      const cycles = 12;
      let tick = 0;
      const interval = setInterval(()=>{
        sEls.forEach((el,i)=>{
          el.textContent = symbols[randomInt(symbols.length)];
        });
        tick++;
        if(tick>=cycles){
          clearInterval(interval);
          // –ø–æ–¥—Å—Ç–∞–≤–ª—è–µ–º –∫–æ–Ω–µ—á–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
          // mapping: s0,s1,s2 are first column top->bottom, s3..s5 second, s6..s8 third
          for(let col=0;col<3;col++){
            for(let r=0;r<3;r++){
              const idx = col*3 + r;
              const el = sEls[idx];
              el.textContent = result[col][r];
            }
          }
        }
      },60);
    }

    function addHistory(text){
      const d = document.createElement('div');
      d.textContent = text;
      historyEl.prepend(d);
      // –æ–≥—Ä–∞–Ω–∏—á–∏–º –∏—Å—Ç–æ—Ä–∏—é
      while(historyEl.children.length>30) historyEl.removeChild(historyEl.lastChild);
    }

    // –ò–≥—Ä–æ–≤–æ–π —Ü–∏–∫–ª
    async function play(){
      if(bet<=0) return alert('–ü–æ—Å—Ç–∞–≤—å—Ç–µ —Å—Ç–∞–≤–∫—É –±–æ–ª—å—à–µ 0');
      if(bet>balance) return alert('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤');
      balance -= bet;
      gamesPlayed++;
      render();

      spinBtn.disabled = true;
      betInc.disabled = betDec.disabled = maxBtn.disabled = true;

      const result = spinReels();
      animateToResult(result);

      // –ñ–¥—ë–º –ø–æ–∫–∞ –∞–Ω–∏–º–∞—Ü–∏—è –∑–∞–∫–æ–Ω—á–∏—Ç—Å—è ‚Äî 0.8s + cycles*60ms ‚âà 1s ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ç–∞–π–º–∞—É—Ç
      await new Promise(res=>setTimeout(res,900));

      const evalr = evaluate(result);
      lastWin = evalr.payout;
      if(evalr.payout>0){
        balance += evalr.payout;
        // —ç—Ñ—Ñ–µ–∫—Ç
        // –ø–æ–¥—Å–≤–µ—Ç–∏–º —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—É—é –ª–∏–Ω–∏—é
        for(let col=0;col<3;col++){
          const centerIdx = col*3 + 1;
          sEls[centerIdx].classList.add('win');
        }
        addHistory(`–í—ã–∏–≥—Ä—ã—à: +${evalr.payout} (${evalr.reason || 'x'})`);
      } else {
        addHistory(`–ü—Ä–æ–∏–≥—Ä—ã—à: -${bet}`);
      }

      // –û–±–Ω–æ–≤–∏–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
      render();

      spinBtn.disabled = false;
      betInc.disabled = betDec.disabled = maxBtn.disabled = false;
    }

    // –°–ª—É—à–∞—Ç–µ–ª–∏
    spinBtn.addEventListener('click', play);

    betInc.addEventListener('click', ()=>{
      bet = Math.min(balance, bet + 10);
      if(bet<=0) bet = 10;
      betAmountEl.textContent = bet;
    });
    betDec.addEventListener('click', ()=>{
      bet = Math.max(1, bet - 10);
      betAmountEl.textContent = bet;
    });
    maxBtn.addEventListener('click', ()=>{
      bet = Math.max(1, balance);
      betAmountEl.textContent = bet;
    });

    give100.addEventListener('click', ()=>{
      balance += 100; render(); addHistory('–ö–∞–∑–∏–Ω–æ –¥–∞—Ä–∏—Ç +100 (–¥–µ–º–æ)');
    });

    resetBtn.addEventListener('click', ()=>{
      if(confirm('–°–±—Ä–æ—Å–∏—Ç—å –±–∞–ª–∞–Ω—Å –∏ –∏—Å—Ç–æ—Ä–∏—é?')){
        balance = 1000; bet = 10; lastWin = 0; gamesPlayed=0; historyEl.innerHTML=''; render();
      }
    });

    // Keyboard shortcuts
    document.addEventListener('keydown', (e)=>{
      if(e.key===' '){ e.preventDefault(); play(); }
      if(e.key==='+') bet += 10, betAmountEl.textContent=bet;
      if(e.key==='-') bet = Math.max(1,bet-10), betAmountEl.textContent=bet;
    });

    // –ë—ã—Å—Ç—Ä–æ–µ –∞–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ –≤ localStorage
    function saveState(){
      const state = {balance,bet,lastWin,gamesPlayed};
      localStorage.setItem('mini-casino-state', JSON.stringify(state));
    }
    function loadState(){
      try{
        const s = JSON.parse(localStorage.getItem('mini-casino-state')||'null');
        if(s){balance=s.balance||balance;bet=s.bet||bet;lastWin=s.lastWin||lastWin;gamesPlayed=s.gamesPlayed||gamesPlayed}
      }catch(e){}
      render();
    }
    loadState();
    setInterval(saveState,2000);
  </script>
</body>
</html>
